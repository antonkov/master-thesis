\chapter{Численный анализ влияния спектров циклов на вероятность ошибки 
декодирования} 

Общий подход к генерации случайного регулярного МППЧ-кода состоит из следующих шагов:
\begin{enumerate}
	\item Выбор весов столбцов и строк базовой матрицы (J,K). В исследовании будут рассмотрены
	(3,6) и (4,8)-регулярные МППЧ-коды, как наиболее применяемые на практике.
	\item Выбор размера базовой матрицы $(n_b,r_b)$. Размер должен удовлетворять соотношению 
	$J \cdot n_b = K \cdot r_b$ (два способа подсчитать число единиц в матрице --- по строкам и по столбцам).
	В исследовании рассмотрен размер (24,12), который удовлетворяет (3,6) и (4,8) с коэффициентам 4 и 3
	соответственно.
	\item Выбор базовой матрицы из фиксированного ансамбля кодов. В исследовании рассмотрены ансамбли
	Галлагера, Ричардсона-Урбанке и квазициклических кодов.
	\item Выбор размера результирующего кода после лифтинга. В исследовании рассмотрены размеры
	576 и 2304, используемые в стандарте 802.16e WiMAX. Коэффициенты лифтинга $M=24$ и $M=96$
	соответственно.
	\item Разметка базовой матрицы весами по модулю $M$. Все разметки приняты равновероятными.
\end{enumerate}

\section{Описание эксперимента}

После исследования некоторых гипотез было решено остановиться на одной из самых простых, которая состоит в
следующем:
\begin{conjecture}
	Код со спектром циклов графа Таннера лексикографически меньшим спектра циклов графа Таннера другого
	кода статистически более эффективен, имеет меньшую вероятность ошибки на блок при фиксированном отношении
	сигнал-шум. Более формально --- достигает вероятности ошибки на блок $10^{-3}$ при меньшем отношении
	сигнал-шум.
\end{conjecture}

Стандартный подход построения графика вероятности ошибки на блок от отношения
сигнал-шум для кода дает наглядное представление об эффективности кода, но не может быть формально использован
для сравнения эффективности двух кодов.

Для сравнения эффективности вводится следующая величина $F$: отношение сигнал-шум при котором кодом
впервые достигается вероятность ошибки на блок не менее $10^{-3}$. Такой способ сравнения был использован,
например, в работе \cite{kudryashov-huawei}.

В первую очередь проведем статистическую проверку гипотезы без фиксированного префикса спектра циклов
графа Таннера, после чего проведем проверку гипотезы в более строгих условиях --- нескольких зафиксированных
первых значениях спектра.

\newcommand{\plotstandard}[2]{
\centerline{\includegraphics[height=3in]{#1}}
\captionof{figure}{#2}
}

\newcommand{\plotsmall}[1]{\includegraphics[height=3.2in]{#1}}

\subsection{Проверка гипотезы без ограничений на спектр}

Исследование было проведено на трех различных ансамблях: Ричардсона-Урбанке, Галлагера и ансамбле
квазициклических кодов, двух фиксированных наборах весов: базовых матриц (3,6) и (4,8), размере
базовой матрицы $24 \times 12$ и двух размерах матриц после лифтинга: с параметром $M=24$ --- $576 \times 288$
и $M=96$ --- $1157 \times 2304$.

Каждым способом было сгенерировано $10^6$ базовых матриц, после чего был произведен отбор трех с лучшим
спектром, трех с худшим и десяти случайных. Базовые матрицы с лучшим и худшим спектром были размечены
случайным образом десять раз. Случайные матрицы были размечены один раз. После чего был
построен график вероятности ошибки от отношения сигнал-шум, представленные ниже.

Каждая линия на графике представляет один код. Линии, представленные зеленым цветом, соответствуют
кодам с лучшим спектром базовой матрицы согласно гипотезе. Линии представленные красным цветом соответствуют кодам с
худшим спектром базовой матрице согласно гипотезе. Синие линии представляют собой случайно сгенерированные
базовые матрицы для сравнения с кодами, отобранными по гипотезе.

\begin{figure}[h!]
\centering
\begin{subfigure}{.5\textwidth}
  \centering
  \plotsmall{../images/r4_576.pdf}
  \caption{Ричардсон-Урбанке 4x8 576}
\end{subfigure}%
\begin{subfigure}{.5\textwidth}
  \centering
  \plotsmall{../images/r4_2304.pdf}
  \caption{Ричардсон-Урбанке 4x8 2304}
\end{subfigure}


\begin{subfigure}{.5\textwidth}
  \centering
  \plotsmall{../images/g4_576.pdf}
  \caption{Галлагер 4x8 576}
\end{subfigure}%
\begin{subfigure}{.5\textwidth}
  \centering
  \plotsmall{../images/q4_576.pdf}
  \caption{Квазициклические коды 4x8 576}
\end{subfigure}

\caption{Графики вероятности ошибки для кодов веса $4 \times 8$}
\end{figure}

\begin{figure}[h!]
\centering
\begin{subfigure}{.5\textwidth}
  \centering
  \plotsmall{../images/g3_576.pdf}
  \caption{Галлагер 3x6 576}
\end{subfigure}%
\begin{subfigure}{.5\textwidth}
  \centering
  \plotsmall{../images/g3_2304.pdf}
  \caption{Галлагер 3x6 2304}
\end{subfigure}

\begin{subfigure}{.5\textwidth}
  \centering
  \plotsmall{../images/q3_2304.pdf}
  \caption{Квазициклические коды 3x6 2304}
\end{subfigure}%
\begin{subfigure}{.5\textwidth}
  \centering
  \plotsmall{../images/q3_576.pdf}
  \caption{Квазициклические коды 3x6 576}
\end{subfigure}

\caption{Графики вероятности ошибки для кодов веса $3 \times 6$}
\end{figure}

Визуально на графиках становится понятно, что коды с лучшим спектром имеют меньшую вероятность ошибки
на блок, чем случайные или коды с худшим спектром, а случайные коды ведут себя лучше, чем коды с
худшим спектром.

Проверим формально с помощью критерия Стьюдента влияние спектра на эффективность декодирования.
В качестве случайной величины будем использовать $F$ --- отношение сигнал-шум для достижения вероятности
$10^{-3}$. В качестве нулевой гипотезы $H_0$ предположим, что спектр не влияет на эффективность декодирования, тогда, отвергнув нулевую гипотезу и исходя из того, что в среднем коды с лучшим спектром эффективнее
кодов с худшим, можно принять как альтернативную гипотезу $H_1$, выдвинутую ранее гипотезу. Также
можем допустить, что выборка случайная, однородная, независимая и имеет распределение близкое к нормальному.
В силу того, что дисперсии заранее неизвестны и могут быть различны для различных кодов, будем
использовать критерий Кохрена-Кокса для взвешенной оценки степени свобод распределения Стьюдента.
\pagebreak

Введем вспомогательные обозначения:

$\{x_i\}$, $\{y_i\}$ --- наборы значений $F$ размеров $m$ и $n$ для кодов с худшим и лучшим спектром соответственно.
\\

\begin{tabular}{l c}
$
\begin{cases}
	\overline{x}=\frac{1}{m}\sum_{i=1}^{m}x_i \\
	\overline{y}=\frac{1}{n}\sum_{i=1}^{n}y_i
\end{cases}
$ & выборочные средние
\end{tabular}

\begin{tabular}{l c}
$\begin{cases}
s_x^2=\frac{1}{m-1}\sum_{i=1}^{m}(x_i-\overline{x})^2 \\
s_y^2=\frac{1}{n-1}\sum_{i=1}^{n}(y_i-\overline{y})^2 \\
 s^2=\frac{1}{m}s_x^2+\frac{1}{n}s_y^2
\end{cases}
$ & выборочные дисперсии
\end{tabular}
\\

$t_{\alpha}(f)$ --- распределение Стьюдента с $f$
степенями свободы.
\\

\begin{tabular}{l c}
$\begin{cases}
\nu_x=\frac{s_x^2}{m} \\
\nu_y=\frac{s_y^2}{n} \\
 t_{\alpha}=\frac{\nu_x t_{\alpha}(m-1)+\nu_y t_{\alpha}(n-1)}{\nu_x+\nu_y}
\end{cases}
$ & критерий Кохрена-Кокса
\end{tabular}
\\

$t=\frac{\overline{x}-\overline{y}}{s}$--- статистика критерия Стьюдента

Таким образом, для опровержения нулевой гипотезы при сравнении двух выборочных средних необходимо
показать, что $t > t'_{\alpha/2}$.

Приведем для справки значения $t'_{\alpha/2}$ для некоторых уровней значимости при фиксированных
размерах выборки $n=30, m=30$.

\begin{tabular}{|c|c|}
	\hline
	$\alpha$ & $t'_{\alpha/2}$ \\
	\hline
	0.0001 & 4.50 \\
	\hline
	0.001 & 3.65 \\
	\hline
	0.01 & 2.75 \\
	\hline
	0.05 & 2.04 \\
	\hline
	0.1 & 1.69 \\
	\hline
\end{tabular}

Теперь приведем таблицу значений статистик для различных ансамблей кодов.

\begin{tabular}{|c|c|c|}
	\hline
	Ансамбль кодов & $t$ & Уровень значимости $\alpha$\\
	\hline
	Ричардсон-Урбанке 4x8 576 & 4.50 &  $\alpha = 0.0001$\\
	\hline
	Ричардсон-Урбанке 4x8 2304 & 29.7 & $\alpha < 0.0001$ \\
	\hline
	Галлагер 4x8 576 & 2.57 & $\alpha \approx 0.01$ \\
	\hline
	Квазициклические коды 4x8 576 & 8.53 & $\alpha < 0.0001$ \\
	\hline
	Галлагер 3x6 576 & 6.57 & $\alpha < 0.0001$ \\
	\hline
	Галлагер 3x6 2304 & 3.32 & $\alpha \approx 0.005$ \\
	\hline
	Квазициклические коды 3x6 2304 & 9.92 & $\alpha < 0.0001$ \\
	\hline
	Квазициклические коды 3x6 576 & 12.92 & $\alpha < 0.0001$ \\
	\hline
\end{tabular}

Таким образом, из таблицы видна несостоятельность нулевой гипотезы, что подтверждает выдвинутую альтернативную
гипотезу без ограничений на спектр.

\subsection{Проверка гипотезы с фиксированным префиксом спектра}

Рассмотрим гипотезу при некотором фиксированном префиксе. Например, сгенерируем несколько кодов,
спектр которых имеет одинаковый префикс. Так, спектр следующих кодов составляет 
$C_4=63, C_6=622, C_8=6961, C_{10}=83856$, но имеет различное количество циклов
длины 12, а именно: первый имеет $C_{12}=1068487$, а второй $C_{12}=1070468$.  (Следует отметить, что без обращения Мебиуса и удаления дубликатов, первый из кодов имел бы больше
циклов длины 8, чем второй из кодов и критерий бы не выполнялся.)

\begin{figure}[h!]
\centering
\begin{subfigure}{.5\textwidth}
  \centering
  \plotsmall{../images/d4n1_576.pdf}
  \caption{Размер кода 576}
\end{subfigure}%
\begin{subfigure}{.5\textwidth}
  \centering
  \plotsmall{../images/d4n1_2304.pdf}
  \caption{Размер кода 2304}
\end{subfigure}
\caption{Два различных кода с одинаковым префиксом спектра}
\end{figure}

Критерий Стьюдента для такого набора составляет $t=2.28$ и $t=10.53$ для размеров 576 и 2304 соответственно.
Это дает уровень значимости $\alpha=0.05$ и $\alpha<0.0001$ соответственно.

Однако, данное измерение свидетельствует только о том, что коды с заданным фиксированным префиксом
 имеют статистическую зависимость эффективности от $C_{12}$. Для демонстрации зависимости на всем
 ансамбле необходимо брать пары кодов, префиксы которых равны между собой, но не обязательно равны
 между парами. 
 
 Некоторым аналогом эксперимента для развития интуиции о исследовании может являться эксперимент
 с лечением пациентов некоторым препаратом, когда измерения необходимо проводить на каждом пациенте
 до применения и после. Аналогом пациента в данном случае будет являться некоторый фиксированный префикс.
 Измерения после лечения --- коды с меньшим числом циклов минимальной длины, не входящей в фиксированный
 префикс. Измерения до лечения --- коды с большим числом циклов. Однако, так как префикс кодов
 гораздо более сильно влияет на эффективность кодов, чем количество текущих циклов, измерения будут
 сильно отличаться: некоторые коды <<до лечения>> с хорошим префиксом будут сильно лучше кодов
 <<после лечения>> с плохим префиксом. Таким образом, коды нужно отнормировать. Среднее значение
 величины $F$ по набору кодов с фиксированным префиксом будет смещаться в 0. Для достаточно точного
 нахождения среднего каждый набор с фиксированным префиксом будет содержать по крайней мере 10
 кодов. Дисперсию в разных группах будем считать одинаковой.
 
 Для проведения исследования было сгенерировано $10^6$ кодов ансамбля Ричардсона-Урбанке $4 \times 8$.
 Сначала все коды были разделены на группы с одинаковым префиксом спектра длины 1, затем длины 2, 3 и 4.
 Для каждой длины были отобраны 7 групп наибольшего размера, затем в каждой группе выбрано 3 кода с минимальным
 числом циклов минимальной незафиксированной длины и 3 кода с максимальным. Каждый из них
 был 5 раз случайно размечен до размера 2304. В случае длины 4 максимальный размер группы кодов 
 с различным спектром составлял 2, поэтому для каждого из них было сгенерировано по 15 случайных разметок. 

После моделирования, получены следующие значения критерия Стьюдента:

\begin{tabular}{|c|c|c|}
	\hline
	Длина префикса & $t$ & Уровень значимости $\alpha$\\
	\hline
	0 & 29.7 &  $\alpha < 0.0001$\\
	\hline
	1 & 5.05 &  $\alpha < 0.0001$\\
	\hline
	2 & 4.28 & $\alpha < 0.0001$ \\
	\hline
	3 & 3.05 & $\alpha \approx 0.005$ \\
	\hline
	4 & 3.36 & $\alpha = 0.001$ \\
	\hline
\end{tabular}

Таблица наглядно демонстрирует, что можно отвергнуть нулевую гипотезу также в случае, когда первое
различие при лексикографическом сравнении спектров выпадает на второе, третье, четвертое или пятое значение.
Причем, явно видно, что зависимость убывает при переходе к большей длине префикса. Исключением
является длина 4, так как не удалось получить достаточное количество кодов в группе с различными 
спектрами, но одинаковым префиксом длины 4, поэтому значение критерия немного смещено.

Таким образом, гипотеза о лексикографическом сравнении спектров для оценки эффективности может быть
принята и использована при поиске МППЧ-кодов.



















































