\chapter{Численный анализ влияния спектров циклов на вероятность ошибки 
декодирования} 

Общий подход к генерации случайного регулярного МППЧ-кода состоит из следующих шагов:
\begin{enumerate}
	\item Выбор весов столбцов и строк базовой матрицы (J,K). В исследовании будут рассмотрены
	(3,6) и (4,8)-регулярные МППЧ-коды, как наиболее применяемые на практике.
	\item Выбор размера базовой матрицы $(n_b,r_b)$. Размер должен удовлетворять соотношению 
	$J \cdot n_b = K \cdot r_b$ (два способа подсчитать число единиц в матрице --- по строкам и по столбцам).
	В исследовании рассмотрен размер (24,12), который удовлетворяет (3,6) и (4,8) с коэффициентам 4 и 3
	соответственно.
	\item Выбор базовой матрицы из фиксированного ансамбля кодов. В исследовании рассмотрены ансамбли
	Галлагера, Ричардсона-Урбанке и Квазициклических кодов.
	\item Выбор размера результирующего кода после лифтинга. В исследовании рассмотрены размеры
	576 и 2304, используемые в стандарте 802.16e WiMAX. Коэффициенты лифтинга $M=24$ и $M=96$
	соответственно.
	\item Разметка базовой матрицы весами по модулю $M$. Все разметки приняты равновероятными.
\end{enumerate}

\section{Описание ансамблей кодов}

Генерация случайных матриц заданного размера с фиксированным числом единиц в строках и столбцах для
задания регулярного МППЧ-кода может производиться различными способами. При проведении
тестирования были рассмотрены следующие ансамбли кодов.

\subsection{Ансамбль Галлагера}

Матрицы в ансамбле Галлагера состоят из полос с фиксированным числом строк в каждой. Каждый столбец
полосы содержит ровно одну единицу. Таким образом число полос равно весу столбца.

Например, рассмотрим (3,6)-код, $M=4$. Такой код состоит из 6 полос, каждая из которых состоит
из $M=4$ строк. Первая строка имеет вид
\setcounter{MaxMatrixCols}{30}
\[
\begin{pmatrix}
1 & 1 & 1 & 1 & 1 & 1 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0
\end{pmatrix}
\]

Остальные $M-1$ строк этой полосы --- сдвиги первой строки на 6 позиций. Таким образом строится первая
полоса. Оставшиеся 2 полосы --- случайные перестановки первой полосы.

В результате получен (24,12)-код, он же (3,6)-регулярный МППЧ-код.

\subsection{Ансамбль Ричардсона-Урбанке}

В ансамбле Ричардсона-Урбанке все (3,6)-регулярные коды равновероятные.

Рассмотрим способ на примере того же (24,12)-кода.
Возьмем последовательность (номера строк единиц):
\[
\begin{pmatrix}
	1 & 1 & 1 & 1 & 1 & 1 & 2 & 2 & 2 & 2 & 2 & 2 & 3 & 3 & 3 & 3 & 3 & 3 & ... & 12 & 12 & 12 & 12 & 12 & 12
\end{pmatrix}
\]

Возьмем случайную перестановку чисел этой последовательности.
Берем первые $J=3$ числа, скажем $7,3,11$. Они указывают номера строк единиц
первого столбца. Берем еще 3 числа и находим второй столбец и так далее.

Этот способ не гарантирует регулярность кода, так как на одной позиции может оказаться две единицы
и таким образом столбец будет содержать меньше чем $J$ строк с единицами. Это оказалось существенно при
проведении экспериментов. Матрицы в которых столбец содержит меньше $J$ строк с единицами
более разряженные и соответственно их граф Таннера содержит меньше циклов. Таким образом такие матрицы
становятся лучшими согласно спектру, но вполне ожидаемо показывают довольно плохие результаты при моделировании.

Таким образом был рассмотрен немного модифицированный ансамбль Ричардсона-Урбанке, который контролировал
регулярность кода, отбрасывая иррегулярные МППЧ-коды. Так как регулярные коды составляют значительную
часть кодов из ансамбля Ричардсона-Урбанке, данная модификация незначительно увеличивает время генерации.
\subsection{Ансамбль квазициклических кодов}

Построение кодов из ансамбля квазициклических кодов осуществляется с помощью той же разметки
некоторой "базовой" матрицы и последующей замены элементов матрицы блоками циркулянтами, как было
описано в разделе о квазициклических МППЧ-кодах.

В качестве базовой матрицы берется матрица из всех единиц, например матрица размера $(3,6)$,
после чего к ней применяется случайная разметка числами $\mu_{ij}$ из кольца по модулю $M$,
 где $M$ коэффициент
расширения:

\[
	H_1 = \begin{pmatrix}
		1 & 1 & 1 & 1 & 1 & 1 \\
		1 & 1 & 1 & 1 & 1 & 1 \\
		1 & 1 & 1 & 1 & 1 & 1
	\end{pmatrix}
	\quad
	\begin{pmatrix}
		\mu_{11} & \mu_{12} & \mu_{13} & \mu_{14} & \mu_{15} & \mu_{16} \\
		\mu_{21} & \mu_{22} & \mu_{23} & \mu_{24} & \mu_{25} & \mu_{26} \\
		\mu_{31} & \mu_{32} & \mu_{33} & \mu_{34} & \mu_{35} & \mu_{36}
	\end{pmatrix}
\]

После элементы $H_1$ заменяются на соответствующие блоки циркулянты и получается матрица из ансамбля
квазициклических кодов $H_B$:

\[
H_B=\begin{pmatrix}
		P^{\mu_{11}}_M & P^{\mu_{12}}_M & P^{\mu_{13}}_M & P^{\mu_{14}}_M & P^{\mu_{15}}_M & P^{\mu_{16}}_M \\
		P^{\mu_{21}}_M & P^{\mu_{22}}_M & P^{\mu_{23}}_M & P^{\mu_{24}}_M & P^{\mu_{25}}_M & P^{\mu_{26}}_M \\
		P^{\mu_{31}}_M & P^{\mu_{32}}_M & P^{\mu_{33}}_M & P^{\mu_{34}}_M & P^{\mu_{35}}_M & P^{\mu_{36}}_M
	\end{pmatrix}
\]

Таким образом при построении матриц заданного размера из ансамбля квазициклических кодов 
процедура разметки и лифтинга
применяется дважды: для создания базовой матрицы и матрицы заданного размера из базовой.

\section{Описание эксперимента}

\newcommand{\plotstandard}[2]{
\centerline{\includegraphics[height=3in]{#1}}
\captionof{figure}{#2}
}
\newcommand{\plotsmall}[1]{\includegraphics[height=1.3in]{#1}}

\plotstandard{../images/r4_576.pdf}{Ричардсон-Урбанке 4x8 576}
\plotstandard{../images/r4_2304.pdf}{Ричардсон-Урбанке 4x8 2304}
\plotstandard{../images/g3_576.pdf}{Галлагер 3x6 576}
\plotstandard{../images/g3_2304.pdf}{Галлагер 3x6 2304}
\plotstandard{../images/g4_576.pdf}{Галлагер 4x8 576}
\plotstandard{../images/q3_576.pdf}{Квазициклические коды 3x6 576}
\plotstandard{../images/q3_2304.pdf}{Квазициклические коды 3x6 2304}
\plotstandard{../images/q4_576.pdf}{Квазициклические коды 4x8 576}

























